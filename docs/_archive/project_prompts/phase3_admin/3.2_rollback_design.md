# Task 3.2: Automatic Rollback Mechanism Design

**Status:** Approved
**Owner:** Gemini Antimatter
**Implementation Task:** 3.4 (Devin AI)

---

## 1. Triggers
Rollback is triggered by:
1.  **Deployment Failure:** CI/CD pipeline reports failure.
2.  **Health Check Failure:** Post-deploy smoke test fails (5xx > 1%).
3.  **Governance Violation:** Runtime monitor detects policy breach.

## 2. Mechanism: "Git Revert + Redeploy"

The agent (or CI script) performs:
1.  **Identify Bad Commit:** `HEAD`.
2.  **Revert:** `git revert HEAD -m "Auto-rollback due to failure"`.
3.  **Push:** Force push or fast-forward to main.
4.  **Notify:** Alert Slack/Email via Admin API.

## 3. State Management
For non-code rollback (e.g., config change), we store checkpoints in `.lattice/checkpoints/`.
*   `lattice-lock rollback --restore-checkpoint <id>`
