# Task 7.4: Security Audit & Sheriff v2 Rules

**Status:** Draft
**Owner:** Gemini Antimatter
**Implementation Task:** 7.5 (Devin AI)

---

## 1. Threat Model
*   **Prompt Injection:** User input manipulating LLM context.
*   **Supply Chain:** Malicious dependencies in `requirements.lock`.
*   **Data Exfiltration:** Models sending code to unknown endpoints.

## 2. Sheriff v2 Ruleset
Expand `Sheriff` static analysis to catch security antipatterns.

| Rule ID | Severity | Description |
|---------|----------|-------------|
| `SEC-001` | Critical | Hardcoded API keys / secrets. |
| `SEC-002` | Error | Use of `eval()` or `exec()`. |
| `SEC-003` | Warning | Network calls outside of `api_clients.py`. |
| `SEC-004` | Error | `subprocess.run` with `shell=True`. |

## 3. Secret Scanning
Integrate `detect-secrets` into the pre-commit hook (Task 2.4 extended).
