# Task 3.1: Error Boundary System Design

**Status:** Approved
**Owner:** Gemini Antimatter
**Implementation Task:** 3.3 (Admin API), 3.4 (Dashboard)

---

## 1. Concept
The system must never crash with a raw Python traceback. Every error must be intercepted, categorized, and presented with a remediation step.

## 2. Exception Hierarchy

```python
class LatticeError(Exception):
    """Base error class."""
    def __init__(self, message: str, remediation: str, code: str):
        self.remediation = remediation
        self.code = code
        super().__init__(message)

class ConfigurationError(LatticeError): ...
class ProviderUnavailableError(LatticeError): ...
class PolicyViolationError(LatticeError): ...
class OrchestratorError(LatticeError): ...
```

## 3. Global Exception Handler
Wrap the CLI entry point (`click.Group`) to catch `LatticeError`.

*   **Output:**
    ```text
    [ERROR] Provider Unavailable (PROV-001)
    Anthropic API returned 503.
    
    [REMEDIATION]
    Check status.anthropic.com. Retry in 5 minutes.
    ```

## 4. Error Telemetry
Errors are logged to `.lattice/errors.log` (JSONL format) and exposed via the Admin API.

## 5. Implementation Tasks
1.  Define hierarchy in `src/lattice_lock/core/exceptions.py`.
2.  Add `handle_exceptions` decorator for CLI commands.
3.  Update all core modules to raise specific `LatticeError` instead of generic `ValueError`.
