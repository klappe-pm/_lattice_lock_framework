# Task 6.3.7 - Task Analyzer v2 Design

**Tool:** Gemini Antimatter (Design Doc)
**Phase:** 6.3 - Orchestrator Feature Completeness
**Dependencies:** None (can run parallel with other 6.3.x)
**Owner:** Gemini Antimatter

---

## Prompt for Gemini Antimatter

You are helping maintain architectural documentation for the lattice-lock-framework.

Task ID: 6.3.7 - Task Analyzer v2 Design

### Context

The current `TaskAnalyzer` in `src/lattice_lock_orchestrator/scorer.py` uses simple keyword matching:
```python
# Current approach (simplified)
if "debug" in prompt.lower():
    return TaskType.DEBUGGING
if "test" in prompt.lower():
    return TaskType.TESTING
```

**Problems:**
- False positives: "test the waters" → TESTING
- False negatives: "find the bug" → not DEBUGGING
- No confidence scores
- No multi-label support

### Goals

Write a design document covering:

1. **Improved Classification Approach**
   Options to evaluate:
   - Enhanced keyword patterns with context
   - TF-IDF with pre-trained categories
   - Small local classifier model
   - LLM-based classification (expensive)
   
   Recommendation with rationale

2. **Feature Extraction**
   What signals to use:
   - Keywords and phrases
   - Code block presence
   - Question patterns
   - Length and complexity
   - Domain-specific terms

3. **Task Type Definitions**
   Refine each task type with:
   - Clear definition
   - Example prompts
   - Distinguishing features
   - Confidence thresholds

4. **Multi-Label Support**
   - Some prompts span multiple types
   - Return ranked list of types
   - Confidence scores per type

5. **Analyzer Interface**
   ```python
   class TaskAnalyzer:
       def analyze(self, prompt: str) -> TaskRequirements:
           ...
       
       def get_task_scores(self, prompt: str) -> dict[TaskType, float]:
           """Return confidence score for each task type."""
           ...
   ```

6. **Configurability**
   - Custom keyword patterns
   - Adjustable thresholds
   - Plugin architecture for custom analyzers

7. **Testing Strategy**
   - Curated test set with labeled prompts
   - Accuracy metrics
   - Regression testing

8. **Implementation Tasks**
   List concrete tasks for Devin AI:
   - Files to modify
   - Test cases to add
   - Benchmarks to run

### Reference Files

- `src/lattice_lock_orchestrator/scorer.py` - Current implementation
- `src/lattice_lock_orchestrator/types.py` - TaskType enum
