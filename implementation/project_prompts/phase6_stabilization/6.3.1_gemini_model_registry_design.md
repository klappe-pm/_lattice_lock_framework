# Task 6.3.1 - Model Registry Source-of-Truth Design

**Tool:** Gemini Antimatter (Design Doc)
**Phase:** 6.3 - Orchestrator Feature Completeness
**Dependencies:** None (can run after Phase 6.1)
**Owner:** Gemini Antimatter

---

## Prompt for Gemini Antimatter

You are helping maintain architectural documentation for the lattice-lock-framework.

Task ID: 6.3.1 - Model Registry Source-of-Truth Design

### Context

The framework claims "63 models from 8 providers" but:
- `models/model_registry.md` documents 63 models (documentation)
- `src/lattice_lock_orchestrator/registry.py` only implements ~10 models (code)

**Current Implementation:**
- Models are hardcoded in `_load_openai_models()`, `_load_anthropic_models()`, etc.
- No external configuration file
- Adding new models requires code changes

### Goals

Write a design document covering:

1. **Registry Source of Truth**
   - Should the source be YAML, JSON, or keep markdown?
   - Recommendation: `models/model_registry.yaml` as machine-readable config
   - How to keep documentation in sync

2. **Registry Schema**
   Define the schema for each model entry:
   ```yaml
   models:
     - id: "gpt-4o"
       provider: "openai"
       display_name: "GPT-4o"
       context_window: 128000
       cost_per_1k_input: 0.005
       cost_per_1k_output: 0.015
       capabilities:
         coding_score: 0.95
         reasoning_score: 0.92
         supports_vision: true
         supports_function_calling: true
       status: "production"  # production | beta | experimental | deprecated
       min_api_version: "2024-01-01"
   ```

3. **Provider Configuration**
   - Required environment variables per provider
   - Base URLs and endpoints
   - Authentication methods

4. **Loading Strategy**
   - When to load registry (startup vs lazy)
   - Caching behavior
   - Hot-reload capability (optional)
   - Validation on load

5. **Migration Path**
   - How to convert existing hardcoded models
   - Backwards compatibility
   - Deprecation of old loading methods

6. **Model Status Semantics**
   - `production`: Fully supported, tested, recommended
   - `beta`: Working but may have issues
   - `experimental`: Use at own risk, may not work
   - `deprecated`: Will be removed, migrate away

7. **Implementation Tasks**
   List concrete tasks for Devin AI:
   - Create `models/model_registry.yaml`
   - Update `registry.py` to load from YAML
   - Add validation for registry format
   - Tests for registry loading

### Reference Files

- `models/model_registry.md` - Current documentation
- `src/lattice_lock_orchestrator/registry.py` - Current implementation
- `src/lattice_lock_orchestrator/types.py` - ModelCapabilities definition
